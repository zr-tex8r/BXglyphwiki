BXglyphwiki パッケージバンドル
==============================

LaTeX: 「グリフウィキ」に登録された文字を利用する

フリーな「漢字字形共有サイト」である [グリフウィキ] で登録された漢字字形
を LaTeX 文書で簡単に利用できるようにする。

[グリフウィキ]: <http://glyphwiki.org/>

### 前提環境

  - フォーマット： LaTeX
  - エンジン： pTeX ／ upTeX ／ XeTeX ／ LuaTeX
  - DVIウェア： dvips ／ dvipdfmx ／ pdfTeX
  - LuaTeX エンジンを Lua インタプリタとして使用するのでインストール
    されている必要がある。
  - インターネットへのアクセス ;-)

### インストール

`bxglyphwiki.sty` は `$TEXMF/tex/latex/BXglyphwiki` に移動する。

`bxglyphwiki.lua` については、それが `bxglyphwiki` というコマンド名で
実行可能であるようにする。具体的な手順は環境により異なる。 
（`$TEXMFBIN` は TeX 関連の実行ファイルの場所を表す。）

  * Unix 系 OS の場合：
      - ファイル名を `bxglyphwiki` に改名する。
      - 先頭の shebang を有効にし、実行可能権限を付与する。
      - 実行パスの通ったディレクトリに置く。

  * Windows 版 TeX Live の場合： 
      - `$TEXMFBIN/runscript.exe` を `bxglyphwiki.exe` という名前で
        コピーする。
      - それを実行パスの通ったディレクトリに置く。
      - `bxglyphwiki.lua` を `$TEXMF/scripts/BXglyphwiki` に移動する。

  * W32TeX の場合： 
      - `$TEXMFBIN/runscr.exe` を `bxglyphwiki.exe` の名前でコピーする。
      - それを `$TEXMFBIN` （または、それと同階層にある、実行パスの
        通ったディレクトリ）に置く。
      - `bxglyphwiki.lua` を `$TEXMF/scripts/BXglyphwiki` に移動する。
        （`bxglyphwiki.exe` と同じディレクトリでもよい。）

上述の説明が実行できない場合は、回避策として、`bxglyphwiki.lua` を
カレントディレクトリ（文書ファイルがある場所）に置いても動作する。

bxglyphwiki パッケージ
----------------------

### パッケージの読込

    \usepackage[<オプション>]{bxglyphwiki}

パッケージオプション：

  - ドライバ指定： `dvips`、`dvipdfmx`、`pdftex`、`xetex` の何れか。
    （graphicx のドライバと同じにする。）
  - `download` （既定）： 「グリフウィキ」サイトからのダウンロードを
    行う。
  - `nodownload` ： ダウンロードを一切行わない。（既にダウンロードされた
    キャッシュファイルのみを使用する。）
  - `dir=<ディレクトリ名>` ： キャッシュファイルを置くディレクトリ。
    既定値は `.`（カレントディレクトリ）。
  - `cache=<数値>` ： キャッシュファイルの有効期限（分単位）。既定値は
    `10080` （一週間）。値を `forever` とすると無期限になる。

本パッケージは graphicx パッケージの読込を必要とする。graphicx が未読込の
場合でドライバ指定がある場合はそのドライバで自動的に graphicx を読み込む。
逆に、graphicx が既に読み込まれている場合は、ドライバ指定が省略可能で、
その場合は graphicx のドライバ指定を引き継ぐ。

本パッケージでは外部 Lua スクリプトの実行を利用するので、シェル呼出機能を
有効にする（コマンドラインで `-shell-escape` オプションを指定する）必要が
ある。シェル呼出機能が無効である場合は自動的に `nodownload` オプション
指定時の動作にフォールバックする。

### 機能

  * `\GWI[*][<バージョン指定>]{<グリフ名>}` ：
    指定のグリフ名の文字（グリフ）を出力する。

バージョン指定のオプションは以下の通り。既定値は `+` であるが、`*` 付き
の場合は `*` となる（`\GWI*{...}` は `\GWI[*]{...}` と同じ）。

  * `<数字>` ： 指定のバージョンのみを使用する。
      - 指定のバージョンのキャッシュが有効（期限内）ならそれを使用。
      - そうでないならダウンロードを行う。
      - それが失敗した場合はフォールバック表示。
  * `+` ： 最新のバージョンを使用する。
      - *何れかのバージョンの* キャッシュが有効なら、 *全ての* バージョン
        の中で最新のものを使用する。
      - そうでないなら最新のバージョンをダウンロードする。
      - それが失敗した場合はフォールバック表示。
  * `*` ： キャッシュの中で最新のバージョンを使用する。
      - *何れかのバージョンの* キャッシュが有効なら、 *全ての* バージョン
        の中で最新のものを使用する。
      - そうでないならキャッシュに存在する全てのバージョンの中で最新の
        ものをダウンロードする。
      - それが失敗した場合はフォールバック表示。
  * `<数字>+` ： `+` と同様だが、指定した値以降のバージョンのみを使用
    する。
  * `<数字>*` ： `*` と同様だが、指定した値以降のバージョンのみを使用
    する。

更新履歴
--------

  * Version 0.2  <2013/10/16>
      - 最初の公開版

--------------------
Takayuki YATO (aka. "ZR")  
http://zrbabbler.sp.land.to/
